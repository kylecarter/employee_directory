var EmployeeDirectory;EmployeeDirectory=function(){var a,b,c,d;return b=new Object,d=function(a){$(document).ready(function(){EmployeeDirectory.utils.handleHashValues(a)})},c=function(){b={status:EmployeeDirectory.utils.getLoginStatus(),anchor:EmployeeDirectory.utils.getAppState()},EmployeeDirectory.utils.handleHashValues(b)},a=function(){b={status:EmployeeDirectory.utils.getLoginStatus(),anchor:EmployeeDirectory.utils.getAppState()},this.container=$("#application-data"),d(b),$(window).on("hashchange",function(){c()})},{initApp:a}}(),EmployeeDirectory.utils=function(){"use strict";var a,b,c,d,e;return b=function(){var a;return a=null!=$.cookie("loggedin")&&"no"!==$.cookie("loggedin")?!0:!1},a=function(){var a;return a=$.uriAnchor.makeAnchorMap()},e=function(){return $(".spinner").show()},d=function(){return $(".spinner").hide()},c=function(a){var b,c;b=$("#content"),c={reset:function(){return b.hasClass("reset-pswrd")?!1:void EmployeeDirectory.reset.configModule()},employee:function(){return b.hasClass("usr-profile")?!1:void EmployeeDirectory.employee.configModule(a.anchor._page.id)},p404:function(){return b.hasClass("notfound")?!1:void EmployeeDirectory.notfound.configModule()},signin:function(){return b.hasClass("loggedout")?!1:void EmployeeDirectory.login.configModule()}},a.status&&"employee"===a.anchor.page&&c.employee(),"reset"===a.anchor.page?($.cookie("loggined","no"),$.removeCookie("user"),c.reset()):"p404"===a.anchor.page?($.cookie("loggined","no"),$.removeCookie("user"),c.p404()):($.cookie("loggined","no"),$.removeCookie("user"),c.signin())},{getLoginStatus:b,getAppState:a,showLoading:e,hideLoading:d,handleHashValues:c}}(),EmployeeDirectory.create=function(){"use strict";var a,b;return a={templates:{appendEmployee:EmployeeDirectoryViews["hbs/NewEmployee.hbs"]}},b=function(b,c,d){var e,f;f="/user/create?";for(e in b)f+=e+"="+b[e]+"&";f+="admin=false",console.log(f),$.ajax({url:"/user/create?"+f,dataType:"json",type:"POST",success:function(e){console.log(e),c.find(".modal-body").append('<p class="msg">New employee added.</p>'),b.curprofile=d,$("#employee-list").append(a.templates.appendEmployee(b))},error:function(a,b,d){console.log(a,b,d),c.find(".modal-body").append('<p class="msg">There was a problem processing your request. Please try again later.</p>')}})},{doAddEmployee:b}}(),EmployeeDirectory["delete"]=function(){"use strict";var a,b,c,d,e;return a=new Object,e=new Object,d=new Object,b=function(){},c=function(){},{configModule:b,initModule:c}}(),EmployeeDirectory.read=function(){"use strict";var a,b,c,d,e,f;return a={templates:{employeeslist:EmployeeDirectoryViews["hbs/EmployeeList.hbs"]}},f=function(a,b){var c,d;for(c=0,d=!1;c<user.length;){if(a===user[c].email&&b===user[c].password){d=user[c];break}c++}return d},e=function(a){return $.ajax({url:"/user/read/"+a,dataType:"json",type:"GET",success:function(a){a.length>0?($.uriAnchor.setAnchor({page:"employee",_page:{id:a[0].employee_id}}),EmployeeDirectory.employee.configModule(a[0])):($.uriAnchor.setAnchor({page:"p404"}),EmployeeDirectory.notfound.configModule({}))},error:function(a,b,c){console.log(a,b,c),$.uriAnchor.setAnchor({page:"p404"}),EmployeeDirectory.notfound.configModule({})}})},c=function(a,b){$.ajax({url:"/user/login?usr="+a.val()+"&pswrd="+b.val(),dataType:"json",type:"POST",success:function(a){a.length>0?($.uriAnchor.setAnchor({page:"employee",_page:{id:a[0].employee_id}}),$.cookie("loggedin","yes"),$.cookie("user",a[0].employee_id),EmployeeDirectory.employee.configModule(a[0])):EmployeeDirectory.notfound.configModule({})},error:function(a,b,c){console.log(a,b,c),$.removeCookie("loggedin"),$.removeCookie("user"),form.after('<div class="container-fluid"><div class="col-sm-12"><p style="margin-top: 18px; font-size: 0.775em;">The information provided does not match a known employee. Please check the information you entered and try again. If you contine to have problems contact IT.</p></div></div>')}})},d=function(){$.uriAnchor.setAnchor({page:"signin"}),$.removeCookie("loggedin"),$.removeCookie("user"),EmployeeDirectory.login.configModule()},b=function(b,c){$.ajax({url:"/user/read",dataType:"json",type:"GET",success:function(d){var e;e=new Object,e.curadmin="true"===c?!0:!1,e.size=d.length,e.employee=d,b.html(function(b,c){return a.templates.employeeslist(e)})},error:function(a,c,d){console.log(a,c,d),b.html(function(a,b){return"<li>We are experiencing some difficulties processing your request. Please try again later.</li>"})}})},{verifyUser:f,validateUser:e,doLogIn:c,doLogOut:d,doListEmployees:b}}(),EmployeeDirectory.update=function(){"use strict";var a,b;return b=function(a,b,c){$.ajax({url:"/user/updatepw/"+b+"?pswrd="+a,dataType:"json",type:"POST",success:function(a){c.find(".msg").length>0?c.find(".msg").html("Your password has been updated."):c.find(".modal-body").append('<p class="msg">Your password has been updated.</p>')},error:function(a,b,d){console.log(a,b,d),c.find(".msg").length>0?c.find(".msg").html("There was a problem processing your request. Please try again later."):c.find(".modal-body").append('<p class="msg">There was a problem processing your request. Please try again later.</p>')}})},a=function(a,b,c){$.ajax({url:"/user/avatar/"+b+"?graphic="+a,dataType:"json",type:"POST",success:function(b){c.find(".msg").length>0?c.find(".msg").html("Your avatar has been updated."):c.find(".modal-body").append('<p class="msg">Your avatar has been updated.</p>'),$("#avatar").find("img")>0?$("#avatar img").attr("src",a):$("#avatar").html('<img src="'+a+'" alt="profile photo">')},error:function(a,b,d){console.log(a,b,d),c.find(".msg").length>0?c.find(".msg").html("There was a problem processing your request. Please try again later."):c.find(".modal-body").append('<p class="msg">There was a problem processing your request. Please try again later.</p>')}})},{doChangePassword:b,doChangeAvatar:a}}(),EmployeeDirectory.contact=function(){"use strict";var a,b,c,d,e;return a=new Object,e=new Object,d=new Object,b=function(){},c=function(){},{configModule:b,initModule:c}}(),EmployeeDirectory.employee=function(){"use strict";var a,b,c,d,e,f,g,h,i;return b={params:null,templates:{shell:EmployeeDirectoryViews["hbs/UserProfile.hbs"],results:EmployeeDirectoryViews["hbs/SearchResults.hbs"],notfound:EmployeeDirectoryViews["hbs/EmployeeNotFound.hbs"],changepswrd:EmployeeDirectoryViews["hbs/ChangePassword.hbs"],changeavtr:EmployeeDirectoryViews["hbs/ChangeAvatar.hbs"],addemployee:EmployeeDirectoryViews["hbs/AddEmployee.hbs"]}},i={status:EmployeeDirectory.utils.getLoginStatus(),anchor:EmployeeDirectory.utils.getAppState()},c=function(a){b.params=a.hasOwnProperty("employee_id")?a:EmployeeDirectory.read.validateUser(a),b.params?EmployeeDirectory.container.html(function(a,c){return b.templates.shell(b.params)}):($.uriAnchor.setAnchor({page:"p404"}),$.removeCookie("loggedin"),$.removeCookie("user"),EmployeeDirectory.notfound.configModule()),h()},a=function(a){EmployeeDirectory.read.doListEmployees(a,$("#content").attr("data-admin"))},g=function(a){a.on("click touchend",function(){var a;$("#myModal").html(b.templates.changepswrd({})),a=$("#ChangePassword"),a.validate({rules:{old:{required:!0},diffrnt:{required:!0},confirm:{required:!0}},messages:{old:"You must enter your old password.",diffrnt:"You must enter a value that does not equal your old passord.",confirm:"Verify you entered the same value as the new password."},validClass:"has-success control-label",errorClass:"has-error control-label",highlight:function(a,b,c){$(a).parent(".form-group").addClass("has-error").removeClass("has-success")},unhighlight:function(a,b,c){$(a).parent(".form-group").addClass("has-success").removeClass("has-error")}}),$("#ChangePassword .btn-primary").on("click touchend",function(){var b,c,d;a.valid()&&(d=$("#old").val(),b=$("#confirm").val(),c=$("#diffrnt").val(),b===c?b!==d&&c!==d?EmployeeDirectory.update.doChangePassword(b,$(".usr-profile").attr("data-id"),a):a.find(".modal-body").append('<p class="msg">Your new password cannot be set to your old password.</p>'):a.find(".modal-body").append('<p class="msg">The new password and confirm password must match.</p>'))})})},e=function(a){a.on("click touchend",function(){var a;$("#myModal").html(b.templates.changeavtr({})),a=$("#ChangeAvatar"),a.validate({rules:{"upload-avatar":{required:!0,url:!0}},messages:{"upload-avatar":"You must enter a valid URL."},validClass:"has-success control-label",errorClass:"has-error control-label",highlight:function(a,b,c){$(a).parent(".form-group").addClass("has-error").removeClass("has-success")},unhighlight:function(a,b,c){$(a).parent(".form-group").addClass("has-success").removeClass("has-error")}}),$("#ChangeAvatar .btn-primary").on("click touchend",function(){a.valid()&&EmployeeDirectory.update.doChangeAvatar($("#upload-avatar").val(),$(".usr-profile").attr("data-id"),a)})})},f=function(a){a.on("click touchend",function(){EmployeeDirectory.read.doLogOut()})},d=function(a){a.on("click touchend",function(){var a;$("#myModal").html(b.templates.addemployee({})),a=$("#AddEmployee"),a.validate({rules:{"new-fname":{required:!0},"new-lname":{required:!0},"job-title":{required:!0},"new-email":{required:!0,email:!0}},messages:{"new-fname":"Employee first name is required","new-lname":"Employee last name is required","job-title":"Employee job title is required","new-email":"A valid employee email address is required"},validClass:"has-success control-label",errorClass:"has-error control-label",highlight:function(a,b,c){$(a).parent(".form-group").addClass("has-error").removeClass("has-success")},unhighlight:function(a,b,c){$(a).parent(".form-group").addClass("has-success").removeClass("has-error")}}),$("#AddEmployee .btn-primary").on("click touchend",function(){var b;a.valid()&&(b={first_name:$("#new-fname").val(),last_name:$("#new-lname").val(),title:$("#job-title").val(),street_address:$("#street").val(),street_address_addtnal:$("#street2").val(),city:$("#city").val(),state:$("#state").val(),zip:$("#zip").val(),phone:$("#new-phone").val(),email:$("#new-email").val()},EmployeeDirectory.create.doAddEmployee(b,a,$(".usr-profile").attr("data-admin")))})})},h=function(){a($("#wrapper")),g($("#change-pswrd.js-modal-trigger")),e($("#update-profile.js-modal-trigger")),f($("#loggout")),d($("#employee-add .js-modal-trigger"))},{configModule:c}}(),EmployeeDirectory.login=function(){"use strict";var a,b,c,d,e,f;return a={params:null,templates:{login:EmployeeDirectoryViews["hbs/LoggedOut.hbs"]}},f={status:EmployeeDirectory.utils.getLoginStatus(),anchor:EmployeeDirectory.utils.getAppState()},b=function(){EmployeeDirectory.container.html(function(b,c){return a.templates.login({})}),d()},d=function(){e($("#log-in"),$("#login-submit")),c($("#forgot"))},e=function(a,b){a.validate({rules:{user:{required:!0},password:{required:!0}},messages:{user:"Verify your user name is accurate.",password:"If you are having trouble with your password, you can request to change it."},validClass:"has-success control-label",errorClass:"has-error control-label",highlight:function(a,b,c){$(a).parent(".log-in__cmnpt").addClass("has-error").removeClass("has-success")},unhighlight:function(a,b,c){$(a).parent(".log-in__cmnpt").addClass("has-success").removeClass("has-error")}}),b.on("click touchend",function(){a.valid()&&EmployeeDirectory.read.doLogIn($("#user"),$("#password"))})},c=function(a){a.on("click touchend",function(){$.uriAnchor.setAnchor({page:"reset"}),EmployeeDirectory.reset.configModule()})},{configModule:b}}(),EmployeeDirectory.notfound=function(){"use strict";var a,b,c,d,e;return a={params:null,templates:{notfound:EmployeeDirectoryViews["hbs/EmployeeNotFound.hbs"]}},e={status:EmployeeDirectory.utils.getLoginStatus(),anchor:EmployeeDirectory.utils.getAppState()},b=function(){EmployeeDirectory.container.html(function(b,c){return a.templates.notfound({})}),c()},c=function(){d($("#notfound"))},d=function(a){a.on("click touchend",function(){$.uriAnchor.setAnchor({page:"signin"}),EmployeeDirectory.login.configModule()})},{configModule:b}}(),EmployeeDirectory.reset=function(){"use strict";var a,b,c,d,e,f;return a={params:null,templates:{reset:EmployeeDirectoryViews["hbs/ResetPsswrd.hbs"]}},f={status:EmployeeDirectory.utils.getLoginStatus(),anchor:EmployeeDirectory.utils.getAppState()},b=function(){EmployeeDirectory.container.html(function(b,c){return a.templates.reset({})}),c()},c=function(){d($("#reset"),$("#request-submit")),e($("#sign-in"))},d=function(a,b){a.validate({rules:{email:{required:!0}},messages:{user:"Verify your email address is accurate.",required:"A valid email address is needed to reset your password."},validClass:"has-success control-label",errorClass:"has-error control-label",highlight:function(a,b,c){$(a).parent(".log-in__cmnpt").addClass("has-error").removeClass("has-success")},unhighlight:function(a,b,c){$(a).parent(".log-in__cmnpt").addClass("has-success").removeClass("has-error")}}),b.on("click touchend",function(){var b;a.valid()&&(EmployeeDirectory.utils.showLoading(),b=window.setTimeout(function(){a.hide(),$("#request-sent").show(),EmployeeDirectory.utils.hideLoading(),window.clearTimeout(b)},900))})},e=function(a){a.on("click touchend",function(){$.uriAnchor.setAnchor({page:"signin"}),EmployeeDirectory.login.configModule()})},{configModule:b}}(),EmployeeDirectory.shell=function(){var a,b;return b={status:EmployeeDirectory.utils.getLoginStatus(),anchor:EmployeeDirectory.utils.getAppState()},a=function(){EmployeeDirectory.utils.handleHashValues()},{initModule:a}}();